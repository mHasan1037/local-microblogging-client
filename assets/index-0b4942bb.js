import{r as c,j as e,L as o}from"./index-acfe17ae.js";import{d as p}from"./dexie-react-hooks-959d3e40.js";import{u as g}from"./index-3e1ae751.js";import{d}from"./db-363a45a4.js";function j(t,s=new Date){const r=new Date(Number(t)*1e3),l=r.getFullYear()===s.getFullYear(),a=r.toLocaleString("en-us",l?{day:"numeric",month:"long",timeZone:"UTC"}:{day:"numeric",month:"long",year:"numeric"}),n=r.toISOString().split("T")[0];return{date:a,htmlDatetime:n}}function f({userId:t}){const[s,r]=c.useState(),[l,a]=c.useState();async function n(){const i=await d.authors.get(t);i&&(r(i.name),a(i.username))}return c.useEffect(()=>{n()},[]),t?e.jsxs("div",{children:[e.jsx(o,{to:`/users/${l}`,className:"link link-neutral",children:s})," ",e.jsx("span",{className:"text-muted",children:`@${l}`})]}):e.jsx("span",{className:"text-muted",children:"Anonimous"})}function v({id:t,heading:s,text:r,createdAt:l,img:a,userId:n}){const[i,h]=c.useState(!1);function m(){d.posts.delete(t)}const{date:u,htmlDatetime:x}=j(l);return e.jsxs("article",{className:"card border border-gray-400 rounded-md mb-3",children:[a&&e.jsx("figure",{children:e.jsx("img",{className:"img-fluid",width:a.width,height:a.height,src:a.url,alt:"Card cap"})}),e.jsxs("div",{className:"card-body pb-0",children:[e.jsxs("div",{className:"bg-transparent border-0 flex justify-between mb-3",children:[e.jsx(f,{userId:n}),e.jsx("p",{className:"card-text text-right",children:e.jsx("time",{dateTime:x,className:"text-muted",children:u})})]}),e.jsx("h3",{className:"card-title link link-primary mb-2 text-3xl",children:e.jsx(o,{to:`/posts/${t}`,className:"",children:s})}),e.jsx("p",{className:"card-text",children:r})]}),e.jsxs("div",{className:"grid grid-cols-12 p-3 pb-1",children:[e.jsx("div",{className:"col-span-6",children:e.jsx("button",{className:"btn btn-circle btn-ghost",title:"Like it!",type:"button",onClick:b=>{h(!i),b.currentTarget.blur()},children:i?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-heart-fill",viewBox:"0 0 16 16",children:e.jsx("path",{fillRule:"evenodd",d:"M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-heart",viewBox:"0 0 16 16",children:e.jsx("path",{d:"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"})})})}),e.jsx("div",{className:"col-span-6 flex justify-end",children:e.jsxs("div",{className:"btn-group-horizontal",role:"group",children:[e.jsx(o,{to:`/posts/${t}/edit`,className:"btn btn-ghost btn-circle",title:"Edit post",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-pencil",viewBox:"0 0 16 16",children:[e.jsx("title",{children:"Pencil"}),e.jsx("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"})]})}),e.jsx("button",{className:"btn btn-ghost btn-circle",title:"Remove post",type:"button",onClick:m,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-trash3",viewBox:"0 0 16 16",children:[e.jsx("title",{children:"Trash can"}),e.jsx("path",{d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"})]})})]})})]})]})}function w(){return e.jsxs("div",{className:"col-span-12 w-full pb-6",children:[e.jsx("input",{disabled:!0,type:"search",className:"disabled:bg-gray-100 rounded-l border border-blue-700 py-1 px-5"}),e.jsx("button",{disabled:!0,type:"button",className:" text-white fill rounded-r border bg-blue-700 border-blue-700 px-5 py-1",children:"Search"})]})}function N(){const t=p.useLiveQuery(()=>d.posts.orderBy("createdAt").reverse().toArray());return t?t.map(s=>e.jsx(c.Fragment,{children:e.jsx(v,{id:s.id,heading:s.heading,text:s.text,img:s.img,createdAt:s.createdAt,userId:s.userId})},s.id)):null}function A(){const t=g("search-bar").on;return e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("main",{className:"grid grid-cols-12 gap-1",children:[t&&e.jsx(w,{}),e.jsx("section",{className:"col-span-12 md:col-span-8 lg:col-span-7",role:"feed",children:e.jsx(N,{})})]})})}export{N as PostList,A as default};
